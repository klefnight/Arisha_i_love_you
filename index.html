<!doctype html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Valentine</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <canvas id="particles" aria-hidden="true"></canvas>

  <!-- Music (starts only after user clicks "Yes") -->
  <audio id="bgm" preload="auto" loop>
    <source src="music.mp3" type="audio/mpeg">
  </audio>

  <!-- Language toggle -->
  <div class="topControls" aria-label="Controls">
    <div class="langToggle" role="group" aria-label="Language">
      <button id="langRu" class="chip is-active" type="button">RU</button>
      <button id="langEn" class="chip" type="button">EN</button>
    </div>

    <button id="soundBtn" class="soundBtn" aria-label="Sound" hidden>ðŸ”‡</button>
  </div>

  <!-- cinematic overlays -->
  <div id="vignette" class="vignette" aria-hidden="true"></div>
  <div id="flash" class="flash" aria-hidden="true"></div>
  <div id="glitch" class="glitch" aria-hidden="true"></div>

  <main class="app" role="main">
    <!-- 1) FIRST SCREEN -->
    <section id="screen-1" class="screen is-active" aria-label="First screen">
      <div class="center">
        <p class="type" id="typewriter" aria-live="polite"></p>
        <p class="hint" id="noHint" role="status" aria-live="polite"></p>

        <div class="btnRow" role="group" aria-label="Choices">
          <button id="yesBtn" class="btn btn-primary" type="button"></button>
          <button id="noBtn" class="btn" type="button"></button>
        </div>
      </div>
    </section>

    <!-- 2) HEART + STORY -->
    <section id="screen-2" class="screen" aria-label="Heart screen">
      <div class="center wide">
        <div class="heartWrap" aria-hidden="true">
          <svg id="heartSvg" viewBox="0 0 600 520" class="heart" focusable="false">
            <defs>
              <filter id="neonGlow" x="-50%" y="-50%" width="200%" height="200%">
                <feGaussianBlur stdDeviation="4" result="blur1" />
                <feGaussianBlur stdDeviation="10" result="blur2" />
                <feMerge>
                  <feMergeNode in="blur2"/>
                  <feMergeNode in="blur1"/>
                  <feMergeNode in="SourceGraphic"/>
                </feMerge>
              </filter>
            </defs>

            <path
              id="heartPath"
              d="M300 470
                 C120 360 60 260 95 185
                 C130 110 220 105 270 165
                 C285 182 293 202 300 220
                 C307 202 315 182 330 165
                 C380 105 470 110 505 185
                 C540 260 480 360 300 470 Z"
              fill="transparent"
              stroke="#ff0033"
              stroke-width="10"
              stroke-linecap="round"
              stroke-linejoin="round"
              filter="url(#neonGlow)"
            />
          </svg>
        </div>

        <div class="story">
          <p id="loadingLine" class="fadeLine" hidden></p>

          <div id="progressWrap" class="progressWrap" hidden aria-label="Loading progress">
            <div class="progressBar" aria-hidden="true">
              <div id="progressFill" class="progressFill"></div>
            </div>
            <div class="progressText"><span id="progressPct">0%</span></div>
          </div>

          <p id="line1" class="fadeLine" hidden></p>
          <p id="dateLine" class="dateLine" hidden></p>
          <p id="line2" class="fadeLine" hidden></p>

          <div id="photoBlock" class="photoBlock" hidden>
            <div class="photoFrame">
              <img src="photo.jpg" alt="Memory" loading="lazy" />
            </div>
            <p id="caption" class="caption"></p>
          </div>

          <div id="finalAsk" class="finalAsk" hidden>
            <p id="finalQ" class="fadeLine is-visible"></p>
            <button id="finalBtn" class="btn btn-primary btn-wide" type="button"></button>
          </div>
        </div>
      </div>
    </section>

    <!-- 3) FINAL SCREEN -->
    <section id="screen-3" class="screen" aria-label="Final screen">
      <div class="center">
        <p id="finalText" class="finalText"></p>
      </div>

      <div id="heartsLayer" class="heartsLayer" aria-hidden="true"></div>
    </section>
  </main>

  <script src="script.js"></script>
</body>
</html>
